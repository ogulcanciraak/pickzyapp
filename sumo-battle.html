<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sumo Sava≈üƒ± - Pickzy</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    
    <link href="https://fonts.googleapis.com/css2?family=Fredoka:wght@400;600;700&family=Quicksand:wght@500;700&display=swap" rel="stylesheet">

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        'title': ['Fredoka', 'sans-serif'],
                        'body': ['Quicksand', 'sans-serif'],
                    },
                    animation: {
                        'bounce-slow': 'bounce 3s infinite',
                        'popIn': 'popIn 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)',
                        'slideUp': 'slideUp 0.5s ease-out',
                        'pulse-fast': 'pulse 1s cubic-bezier(0.4, 0, 0.6, 1) infinite',
                    },
                    keyframes: {
                        popIn: {
                            '0%': { transform: 'scale(0.5)', opacity: '0' },
                            '100%': { transform: 'scale(1)', opacity: '1' },
                        },
                        slideUp: {
                            '0%': { transform: 'translateY(20px)', opacity: '0' },
                            '100%': { transform: 'translateY(0)', opacity: '1' },
                        }
                    }
                }
            }
        }
    </script>
    
    <style>
        body { 
            background-color: #4c1d95;
            background-image: 
                radial-gradient(at 0% 0%, hsla(253,16%,7%,1) 0, transparent 50%), 
                radial-gradient(at 50% 0%, hsla(225,39%,30%,1) 0, transparent 50%), 
                radial-gradient(at 100% 0%, hsla(339,49%,30%,1) 0, transparent 50%);
            font-family: 'Quicksand', sans-serif;
            overflow: hidden;
        }
        
        .custom-scrollbar::-webkit-scrollbar { width: 6px; }
        .custom-scrollbar::-webkit-scrollbar-track { background: rgba(0,0,0,0.1); border-radius: 4px; }
        .custom-scrollbar::-webkit-scrollbar-thumb { background: rgba(139, 92, 246, 0.5); border-radius: 4px; }
        
        /* Ana Sayfa Butonu */
        .home-btn-fixed {
            position: absolute;
            top: 20px;
            left: 20px;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: white;
            padding: 10px 16px;
            border-radius: 12px;
            cursor: pointer;
            font-weight: 700;
            font-size: 0.9rem;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            z-index: 100;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            gap: 8px;
            text-decoration: none;
        }
        .home-btn-fixed:hover {
            transform: translateY(-2px);
            background: rgba(255, 255, 255, 0.2);
            box-shadow: 0 6px 16px rgba(0,0,0,0.2);
        }

        /* Canvas D√ºzeltmeleri */
        canvas {
            max-width: 100%;
            max-height: 80vh;
            aspect-ratio: 1/1;
            /* Arka planƒ± ≈üeffaf yaptƒ±k, b√∂ylece dƒ±≈ütaki beyaz √ßember gitti */
            background-color: transparent; 
            /* Kenarlƒ±k ve yuvarlaklƒ±ƒüƒ± kaldƒ±rdƒ±k, √ßizimi JS yapacak */
            border: none;
            box-shadow: none;
        }
    </style>
</head>
<body class="min-h-screen flex items-center justify-center p-4 text-slate-800">

    <button class="home-btn-fixed" onclick="location.href='index.html'">
        <span>üè†</span> Ana Sayfa
    </button>

    <div class="w-full max-w-4xl bg-white/95 backdrop-blur-xl rounded-[2rem] shadow-2xl overflow-hidden border border-white/20 relative animate-slideUp flex flex-col max-h-[90vh]">
        
        <div id="setupScreen" class="flex flex-col h-full overflow-hidden">
            <div class="bg-slate-50 p-6 border-b border-slate-200 flex flex-col items-center justify-center relative shrink-0">
                <div class="absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-orange-400 via-red-500 to-purple-600"></div>
                <h1 class="font-title text-4xl md:text-5xl font-black text-slate-800 tracking-tight flex items-center gap-3">
                    <span class="text-5xl animate-bounce-slow">ü•ã</span> 
                    <span class="bg-clip-text text-transparent bg-gradient-to-r from-orange-500 to-red-600">Sumo</span> Sava≈üƒ±
                </h1>
                <p class="text-slate-500 font-bold mt-2">Arenada kalan son ki≈üi kazanƒ±r!</p>
            </div>

            <div class="p-6 md:p-8 flex flex-col gap-6 flex-1 overflow-y-auto custom-scrollbar">
                <div class="flex gap-3 shrink-0">
                    <div class="relative flex-1 group">
                        <div class="absolute -inset-0.5 bg-gradient-to-r from-orange-400 to-red-600 rounded-xl opacity-30 group-hover:opacity-100 transition duration-300 blur-sm"></div>
                        <input type="text" id="playerInput" placeholder="Yarƒ±≈ümacƒ± Ekle (√∂rn: Pizza)" 
                            class="relative w-full bg-white border-none rounded-xl px-5 py-4 text-lg font-bold text-slate-700 placeholder:text-slate-400 focus:outline-none focus:ring-0 shadow-sm" maxlength="20">
                    </div>
                    <button onclick="addPlayer()" class="bg-gradient-to-r from-orange-500 to-red-600 hover:from-orange-600 hover:to-red-700 text-white p-4 rounded-xl shadow-lg shadow-orange-500/30 transition-transform active:scale-95">
                        <svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><line x1="12" y1="5" x2="12" y2="19"></line><line x1="5" y1="12" x2="19" y2="12"></line></svg>
                    </button>
                </div>

                <div class="flex gap-3 justify-center shrink-0">
                    <button onclick="loadRandomData()" class="flex-1 bg-indigo-50 hover:bg-indigo-100 text-indigo-600 font-bold py-3 rounded-xl transition-colors border border-indigo-200 flex items-center justify-center gap-2">
                        <span>üé≤</span> Rastgele
                    </button>
                    <button onclick="clearAllPlayers()" class="flex-1 bg-red-50 hover:bg-red-100 text-red-500 font-bold py-3 rounded-xl transition-colors border border-red-200 flex items-center justify-center gap-2">
                        <span>üóëÔ∏è</span> Temizle
                    </button>
                </div>

                <div class="bg-slate-50 rounded-2xl p-4 border border-slate-200 flex-1 flex flex-col min-h-[150px]">
                    <div class="flex justify-between items-center mb-3 px-2 shrink-0">
                        <span class="text-xs font-bold text-slate-400 uppercase tracking-wider">Yarƒ±≈ümacƒ±lar</span>
                        <span id="countBadge" class="bg-slate-200 text-slate-600 text-xs font-bold px-2 py-1 rounded-md">0/12</span>
                    </div>
                    <div id="playerGrid" class="grid grid-cols-2 md:grid-cols-3 gap-3 overflow-y-auto custom-scrollbar content-start">
                        </div>
                </div>

                <button id="startBtn" onclick="startGame()" disabled class="w-full shrink-0 bg-slate-800 text-white font-title text-2xl font-bold py-5 rounded-2xl shadow-xl shadow-slate-400/50 disabled:opacity-50 disabled:cursor-not-allowed disabled:shadow-none transition-all hover:-translate-y-1 active:translate-y-0 group relative overflow-hidden">
                    <div class="absolute inset-0 bg-gradient-to-r from-transparent via-white/10 to-transparent translate-x-[-100%] group-hover:animate-[shimmer_1.5s_infinite]"></div>
                    <span class="flex items-center justify-center gap-3">
                        BA≈ûLAT <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor"><polygon points="5 3 19 12 5 21 5 3"/></svg>
                    </span>
                </button>
            </div>
        </div>

        <div id="gameScreen" class="hidden flex-col h-full bg-slate-900 absolute inset-0 z-20">
            <div class="bg-slate-800 px-6 py-4 flex justify-between items-center shadow-md z-10 shrink-0">
                <div class="flex items-center gap-4">
                    <div class="bg-slate-700/50 px-4 py-2 rounded-lg border border-slate-600 flex items-center gap-3">
                        <div class="w-2.5 h-2.5 bg-green-500 rounded-full animate-pulse shadow-[0_0_10px_#22c55e]"></div>
                        <span class="text-slate-200 font-bold text-sm">KALAN: <span id="remaining" class="text-white text-lg ml-1">0</span></span>
                    </div>
                    <div id="dangerBadge" class="hidden bg-red-500/20 text-red-400 px-3 py-1 rounded border border-red-500/30 text-xs font-bold animate-pulse-fast flex items-center gap-2">
                        ‚ö†Ô∏è ARENA DARALIYOR
                    </div>
                </div>
                <button onclick="resetGame()" class="text-slate-400 hover:text-white transition-colors bg-white/5 hover:bg-white/10 p-2 rounded-lg flex items-center gap-2 text-sm font-bold">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"/><path d="M3 3v5h5"/></svg>
                    D√úZENLE
                </button>
            </div>

            <div class="flex-1 relative bg-slate-900 flex items-center justify-center overflow-hidden p-4">
                <canvas id="canvas" width="800" height="800"></canvas>
                
                <div id="countdown" class="absolute inset-0 flex items-center justify-center pointer-events-none hidden z-30">
                    <span class="text-[120px] font-black text-white drop-shadow-[0_10px_20px_rgba(0,0,0,0.5)] animate-bounce font-title">3</span>
                </div>
            </div>
        </div>

        <div id="winnerModal" class="absolute inset-0 z-50 hidden bg-slate-900/90 backdrop-blur-md items-center justify-center p-4">
            <div class="bg-white rounded-3xl p-1 w-full max-w-sm shadow-2xl animate-popIn">
                <div class="bg-gradient-to-b from-slate-50 to-white rounded-[1.4rem] p-8 text-center relative overflow-hidden">
                    <div class="absolute top-0 left-1/2 -translate-x-1/2 w-full h-full bg-[radial-gradient(circle_at_top,#fbbf24_0%,transparent_60%)] opacity-20"></div>
                    
                    <div class="relative z-10">
                        <div class="text-6xl mb-4 animate-bounce-slow">üèÜ</div>
                        <h2 class="text-sm font-bold text-slate-400 uppercase tracking-widest mb-1">≈ûAMPƒ∞YON</h2>
                        <div id="winnerName" class="text-4xl font-black text-slate-800 mb-8 break-words leading-tight"></div>
                        
                        <div class="flex flex-col gap-3">
                            <button onclick="startGame()" class="w-full bg-orange-500 hover:bg-orange-600 text-white font-bold py-4 rounded-xl shadow-lg shadow-orange-500/30 transition-all active:scale-95">
                                TEKRAR OYNA
                            </button>
                            <button onclick="resetGame()" class="w-full bg-slate-100 hover:bg-slate-200 text-slate-600 font-bold py-4 rounded-xl transition-all">
                                YENƒ∞ KURULUM
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

    </div>

    <div id="toast" class="fixed top-4 right-4 bg-white text-slate-800 px-6 py-4 rounded-xl shadow-2xl border-l-4 border-green-500 transform translate-x-[150%] transition-transform duration-300 z-[100] flex items-center gap-3 font-bold">
        <span>‚úÖ</span>
        <span id="toastMsg">ƒ∞≈ülem ba≈üarƒ±lƒ±</span>
    </div>

    <script>
        // --- ORƒ∞Jƒ∞NAL Fƒ∞Zƒ∞K AYARLARI ---
        const PHYSICS = {
            speed: 0.65, friction: 0.97, bounce: 0.90, turnSpeed: 0.20,
            dashForce: 1.8, crawlForce: 0.15, antiOrbitPull: 0.18, pushForce: 1.2, separation: 0.75
        };
        const ARENA = { baseSize: 220, shrinkEnabled: true, shrinkSpeed: 0.15, shrinkThreshold: 130 };
        const GAME = { maxPlayers: 12, sumoRadius: 24, countdownDuration: 3 };

        // State
        let players = [];
        let sumos = [];
        let gameActive = false;
        let arenaRadius = ARENA.baseSize;
        let animationId = null;
        let countdownInterval = null;

        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');

        // Renkler
        const bodyTones = ['#fca5a5', '#fdba74', '#fcd34d', '#86efac', '#93c5fd', '#c4b5fd', '#f9a8d4'];
        const beltColors = ['#dc2626', '#ea580c', '#d97706', '#16a34a', '#2563eb', '#7c3aed', '#db2777'];

        // --- UI FONKSƒ∞YONLARI ---
        function showToast(msg, type = 'success') {
            const toast = document.getElementById('toast');
            const msgEl = document.getElementById('toastMsg');
            msgEl.innerText = msg;
            toast.className = `fixed top-4 right-4 bg-white text-slate-800 px-6 py-4 rounded-xl shadow-2xl border-l-4 transform transition-transform duration-300 z-[100] flex items-center gap-3 font-bold ${type === 'error' ? 'border-red-500' : 'border-green-500'}`;
            toast.style.transform = 'translateX(0)';
            setTimeout(() => { toast.style.transform = 'translateX(150%)'; }, 2500);
        }

        const randomDatasets = [
            ['Pizza', 'Burger', 'Sushi', 'Kebap', 'D√∂ner', 'Mantƒ±'],
            ['Marvel', 'DC', 'Star Wars', 'Harry Potter', 'LOTR'],
            ['Nike', 'Adidas', 'Puma', 'New Balance', 'Reebok']
        ];

        function loadRandomData() {
            players = [];
            const dataset = randomDatasets[Math.floor(Math.random() * randomDatasets.length)];
            dataset.forEach(name => players.push({ id: Date.now() + Math.random(), name }));
            renderPlayers();
            showToast('Rastgele liste y√ºklendi!');
        }

        function clearAllPlayers() {
            if (players.length === 0) return showToast('Zaten bo≈ü!', 'error');
            if (confirm('T√ºm listeyi silmek istediƒüinize emin misiniz?')) {
                players = [];
                renderPlayers();
                showToast('Liste temizlendi.');
            }
        }

        function addPlayer() {
            const input = document.getElementById('playerInput');
            const name = input.value.trim();
            if (!name) return;
            if (players.length >= GAME.maxPlayers) return showToast(`Max ${GAME.maxPlayers} ki≈üi!`, 'error');
            if (players.some(p => p.name.toLowerCase() === name.toLowerCase())) return showToast('Bu isim zaten var!', 'error');

            players.push({ id: Date.now(), name });
            input.value = '';
            input.focus();
            renderPlayers();
        }

        function removePlayer(id) {
            players = players.filter(p => p.id !== id);
            renderPlayers();
        }

        function renderPlayers() {
            const grid = document.getElementById('playerGrid');
            const count = document.getElementById('countBadge');
            const btn = document.getElementById('startBtn');
            
            count.innerText = `${players.length}/${GAME.maxPlayers}`;
            btn.disabled = players.length < 2;

            if (players.length === 0) {
                grid.innerHTML = '<div class="col-span-full text-center py-10 text-slate-400 italic">Hen√ºz kimse arenaya √ßƒ±kmadƒ±.<br>Yukarƒ±dan eklemeye ba≈üla!</div>';
                return;
            }

            grid.innerHTML = players.map((p, i) => `
                <div class="group bg-white border border-slate-200 p-3 rounded-xl shadow-sm hover:shadow-md hover:border-orange-200 transition-all flex items-center gap-2 animate-popIn" style="animation-delay: ${i * 0.05}s">
                    <div class="w-8 h-8 rounded-full bg-slate-100 text-slate-500 font-bold flex items-center justify-center text-xs shrink-0">${i+1}</div>
                    <span class="font-bold text-slate-700 truncate flex-1">${p.name}</span>
                    <button onclick="removePlayer(${p.id})" class="text-slate-300 hover:text-red-500 transition-colors p-1">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M18 6 6 18"/><path d="m6 6 18 18"/></svg>
                    </button>
                </div>
            `).join('');
        }

        // --- OYUN Y√ñNETƒ∞Mƒ∞ ---
        function startGame() {
            document.getElementById('gameScreen').classList.remove('hidden');
            document.getElementById('gameScreen').classList.add('flex');
            document.getElementById('winnerModal').classList.add('hidden');
            document.getElementById('winnerModal').classList.remove('flex');

            const countdownEl = document.getElementById('countdown');
            countdownEl.classList.remove('hidden');
            let count = GAME.countdownDuration;
            countdownEl.innerHTML = `<span class="text-[120px] font-black text-white drop-shadow-md animate-bounce font-title">${count}</span>`;

            countdownInterval = setInterval(() => {
                count--;
                if (count > 0) {
                    countdownEl.innerHTML = `<span class="text-[120px] font-black text-white drop-shadow-md animate-bounce font-title">${count}</span>`;
                } else if (count === 0) {
                    countdownEl.innerHTML = `<span class="text-[100px] font-black text-orange-500 drop-shadow-md animate-bounce font-title">D√ñV√ú≈û!</span>`;
                } else {
                    countdownEl.classList.add('hidden');
                    clearInterval(countdownInterval);
                    initGame();
                }
            }, 1000);
        }

        function initGame() {
            arenaRadius = ARENA.baseSize;
            gameActive = true;

            const centerX = canvas.width / 2;
            const centerY = canvas.height / 2;

            sumos = players.map((player, i) => {
                const angle = (i / players.length) * Math.PI * 2;
                const startDist = arenaRadius * 0.7;

                return {
                    id: player.id,
                    name: player.name,
                    bodyColor: bodyTones[i % bodyTones.length],
                    beltColor: beltColors[i % beltColors.length],
                    x: centerX + Math.cos(angle) * startDist,
                    y: centerY + Math.sin(angle) * startDist,
                    radius: GAME.sumoRadius,
                    vx: 0, vy: 0,
                    mass: 1 + Math.random() * 0.2,
                    active: true,
                    angle: angle + Math.PI,
                    cooldown: Math.random() * 30
                };
            });

            updateRemaining();
            animate();
        }

        // --- Fƒ∞Zƒ∞K MOTORU ---
        function updatePhysics() {
            if (!gameActive) return;

            const centerX = canvas.width / 2;
            const centerY = canvas.height / 2;

            if (ARENA.shrinkEnabled && arenaRadius > ARENA.shrinkThreshold) {
                arenaRadius -= ARENA.shrinkSpeed;
                document.getElementById('dangerBadge').classList.remove('hidden');
                document.getElementById('dangerBadge').classList.add('flex');
            } else {
                document.getElementById('dangerBadge').classList.add('hidden');
                document.getElementById('dangerBadge').classList.remove('flex');
            }

            let activeCount = 0;
            let lastActive = null;
            sumos.forEach(s => { if (s.active) activeCount++; });
            const finalBattleBoost = activeCount === 2 ? 1.12 : 1.0;

            sumos.forEach((s1, i) => {
                if (!s1.active) return;
                lastActive = s1;

                let target = null;
                let minDist = Infinity;
                sumos.forEach((s2, j) => {
                    if (i !== j && s2.active) {
                        const dx = s2.x - s1.x;
                        const dy = s2.y - s1.y;
                        const dist = Math.sqrt(dx*dx + dy*dy);
                        if (dist < minDist) { minDist = dist; target = s2; }
                    }
                });

                if (target) {
                    const dx = target.x - s1.x;
                    const dy = target.y - s1.y;
                    const targetAngle = Math.atan2(dy, dx);
                    
                    let diff = targetAngle - s1.angle;
                    while (diff < -Math.PI) diff += Math.PI * 2;
                    while (diff > Math.PI) diff -= Math.PI * 2;
                    s1.angle += diff * PHYSICS.turnSpeed;

                    if (s1.cooldown <= 0) {
                        if (Math.abs(diff) < 0.8) {
                            s1.vx += Math.cos(s1.angle) * PHYSICS.dashForce * PHYSICS.speed * finalBattleBoost;
                            s1.vy += Math.sin(s1.angle) * PHYSICS.dashForce * PHYSICS.speed * finalBattleBoost;
                            s1.cooldown = 30 + Math.random() * 30;
                        }
                    } else {
                        s1.cooldown--;
                        if (minDist < 150) {
                            const pullX = (dx / minDist) * PHYSICS.antiOrbitPull * PHYSICS.speed * finalBattleBoost;
                            const pullY = (dy / minDist) * PHYSICS.antiOrbitPull * PHYSICS.speed * finalBattleBoost;
                            s1.vx += pullX; s1.vy += pullY;
                        }
                        if (minDist < 60) {
                            const pushX = (dx / minDist) * PHYSICS.pushForce * finalBattleBoost;
                            const pushY = (dy / minDist) * PHYSICS.pushForce * finalBattleBoost;
                            s1.vx += pushX; s1.vy += pushY;
                        }
                        s1.vx += Math.cos(s1.angle) * PHYSICS.crawlForce * PHYSICS.speed * finalBattleBoost;
                        s1.vy += Math.sin(s1.angle) * PHYSICS.crawlForce * PHYSICS.speed * finalBattleBoost;
                    }
                }

                s1.x += s1.vx; s1.y += s1.vy;
                s1.vx *= PHYSICS.friction; s1.vy *= PHYSICS.friction;

                const distFromCenter = Math.sqrt(Math.pow(s1.x - centerX, 2) + Math.pow(s1.y - centerY, 2));
                if (distFromCenter > arenaRadius + s1.radius) s1.active = false;

                sumos.forEach((s2, j) => {
                    if (i >= j || !s2.active) return;
                    const dx = s2.x - s1.x;
                    const dy = s2.y - s1.y;
                    const dist = Math.sqrt(dx*dx + dy*dy);
                    const minD = s1.radius + s2.radius;

                    if (dist < minD) {
                        const nx = dx / dist; const ny = dy / dist;
                        const overlap = minD - dist;
                        const correction = (overlap * PHYSICS.separation) / ((1/s1.mass) + (1/s2.mass));
                        
                        s1.x -= (1/s1.mass) * correction * nx; s1.y -= (1/s1.mass) * correction * ny;
                        s2.x += (1/s2.mass) * correction * nx; s2.y += (1/s2.mass) * correction * ny;

                        const dvx = s2.vx - s1.vx;
                        const dvy = s2.vy - s1.vy;
                        const velAlongNormal = dvx * nx + dvy * ny;

                        if (velAlongNormal > 0) return;

                        const jVal = -(1 + PHYSICS.bounce) * velAlongNormal;
                        const impulse = jVal / ((1/s1.mass) + (1/s2.mass));

                        s1.vx -= (1/s1.mass) * impulse * nx * 1.2; s1.vy -= (1/s1.mass) * impulse * ny * 1.2;
                        s2.vx += (1/s2.mass) * impulse * nx * 1.2; s2.vy += (1/s2.mass) * impulse * ny * 1.2;
                        
                        s1.vx -= nx * 0.5; s1.vy -= ny * 0.5;
                        s2.vx += nx * 0.5; s2.vy += ny * 0.5;
                    }
                });
            });

            if (activeCount <= 1 && gameActive) {
                gameActive = false;
                if (lastActive) showWinner(lastActive);
            }
            updateRemaining();
        }

        // --- √áƒ∞Zƒ∞M ---
        function draw() {
            const centerX = canvas.width / 2;
            const centerY = canvas.height / 2;

            ctx.clearRect(0, 0, canvas.width, canvas.height);

            // Arena (≈ûƒ±k G√∂lge ile)
            ctx.save();
            ctx.shadowColor = 'rgba(0, 0, 0, 0.5)';
            ctx.shadowBlur = 40;
            ctx.shadowOffsetY = 10;
            
            ctx.beginPath();
            ctx.arc(centerX, centerY, arenaRadius, 0, Math.PI * 2);
            ctx.fillStyle = '#f8fafc';
            ctx.fill();
            ctx.restore();

            // Arena Kenarlƒ±ƒüƒ±
            ctx.lineWidth = 12;
            ctx.strokeStyle = '#334155';
            ctx.stroke();

            // Tehlike B√∂lgesi
            if (ARENA.shrinkEnabled && arenaRadius < ARENA.baseSize - 20) {
                ctx.beginPath();
                ctx.arc(centerX, centerY, arenaRadius, 0, Math.PI * 2);
                ctx.strokeStyle = 'rgba(239, 68, 68, 0.4)';
                ctx.lineWidth = 8;
                ctx.stroke();
            }

            // Sumocular
            sumos.forEach(s => {
                if (!s.active) return;
                ctx.save();
                ctx.translate(s.x, s.y);
                ctx.rotate(s.angle);

                // G√∂lge
                ctx.shadowColor = 'rgba(0, 0, 0, 0.2)';
                ctx.shadowBlur = 10;
                ctx.shadowOffsetX = 2; ctx.shadowOffsetY = 2;

                // G√∂vde
                ctx.beginPath();
                ctx.arc(0, 0, s.radius, 0, Math.PI * 2);
                ctx.fillStyle = s.bodyColor;
                ctx.fill();
                ctx.lineWidth = 2;
                ctx.strokeStyle = 'rgba(0,0,0,0.15)';
                ctx.stroke();

                ctx.shadowColor = 'transparent';

                // Kemer
                ctx.fillStyle = s.beltColor;
                ctx.fillRect(-s.radius, -8, s.radius * 2, 16);

                // Kafa
                ctx.beginPath();
                ctx.arc(0, 0, s.radius * 0.35, 0, Math.PI * 2);
                ctx.fillStyle = '#1e293b';
                ctx.fill();

                // Kollar
                ctx.beginPath();
                ctx.arc(s.radius * 0.7, -s.radius * 0.5, 6, 0, Math.PI * 2);
                ctx.arc(s.radius * 0.7, s.radius * 0.5, 6, 0, Math.PI * 2);
                ctx.fillStyle = s.bodyColor;
                ctx.fill();

                ctx.restore();

                // ƒ∞sim
                ctx.fillStyle = '#f8fafc'; // Karanlƒ±k modda okunabilirlik i√ßin a√ßƒ±k renk
                ctx.font = 'bold 16px Quicksand';
                ctx.textAlign = 'center';
                ctx.shadowColor = 'rgba(0,0,0,0.8)'; // Yazƒ± g√∂lgesi
                ctx.shadowBlur = 4;
                ctx.fillText(s.name.substring(0, 10), s.x, s.y - s.radius - 12);
                ctx.shadowColor = 'transparent';
            });
        }

        function animate() {
            updatePhysics();
            draw();
            if (gameActive) animationId = requestAnimationFrame(animate);
        }

        function updateRemaining() {
            document.getElementById('remaining').innerText = sumos.filter(s => s.active).length;
        }

        function showWinner(winner) {
            setTimeout(() => {
                document.getElementById('winnerName').innerText = winner.name;
                document.getElementById('winnerModal').classList.remove('hidden');
                document.getElementById('winnerModal').classList.add('flex');
            }, 500);
        }

        function resetGame() {
            gameActive = false;
            cancelAnimationFrame(animationId);
            clearInterval(countdownInterval);
            
            document.getElementById('gameScreen').classList.add('hidden');
            document.getElementById('gameScreen').classList.remove('flex');
            document.getElementById('setupScreen').classList.remove('hidden');
            document.getElementById('winnerModal').classList.add('hidden');
            document.getElementById('winnerModal').classList.remove('flex');
            
            sumos = [];
        }

        document.getElementById('playerInput').addEventListener('keypress', (e) => {
            if (e.key === 'Enter') addPlayer();
        });

        renderPlayers();
    </script>
</body>
</html>